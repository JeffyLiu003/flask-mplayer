{% from "_formhelpers.html" import render_field %}

{% extends 'layout.html' %}
{% block content %}

<script type='text/javascript'>

function delete_song(song_id){
    var http = new XMLHttpRequest();
    var url = "/action/delete";
    var params = "id=" + song_id;
    http.open("POST", url, true);

    //Send the proper header information along with the request
    http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    http.setRequestHeader("Content-length", params.length);
    http.setRequestHeader("Connection", "close");

    http.onreadystatechange = function() {//Call a function when the state changes.
        if(http.readyState == 4 && http.status == 200) {
            document.getElementById('song_'+song_id).style.display = 'none';
        }else{
            document.getElementById('song_'+song_id).style.backgroundColor = 'red';
        }
    }
    http.send(params);
}
</script>

<table class='table'>
    <tr>
        <th>ID</th>
        <th>Artist</th>
        <th>Title</th>
        <th>Action</th>
    </tr>
    {% for song in songs %}
        <tr id='song_{{ song.id }}'>
            <td>{{ song.id }}</td>
            <td>{{ song.artist }}</td>
            <td>{{ song.title }}</td>
            <td><button onclick='return delete_song({{ song.id }});'>Delete</button></td>
        </tr>
    {% endfor %}
</table>

{% endblock %}